<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∏‡¶π‡¶ú ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ - ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            padding-bottom: 20px;
        }
        .ad-loading {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
    <script src='//libtl.com/sdk.js' data-zone='10166009' data-sdk='show_10166009'></script>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-4">
        <!-- ‡¶π‡ßá‡¶°‡¶æ‡¶∞ -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-4 text-white mb-4">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="font-bold text-lg">‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</h2>
                    <p class="text-white/80 text-sm">‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßá ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                </div>
                <i class="fas fa-play-circle text-2xl"></i>
            </div>
        </div>

        <!-- ‡¶è‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ -->
        <div class="bg-white rounded-xl p-4 shadow-sm mb-4 text-center">
            <div class="mb-4">
                <h3 class="font-bold text-lg mb-2">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶è‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü</h3>
                <div class="text-4xl font-bold text-blue-600" id="adsCounter">0/10</div>
                <p class="text-gray-500 text-sm mt-2">‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡ßü ‡ßß‡ß¶‡¶ü‡¶ø ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®</p>
            </div>
            
            <div class="w-full bg-gray-200 rounded-full h-3 mb-4">
                <div id="progressBar" class="bg-green-500 h-3 rounded-full" style="width: 0%"></div>
            </div>
        </div>

        <!-- ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ -->
        <div class="bg-white rounded-xl p-4 shadow-sm mb-4">
            <div class="text-center mb-4">
                <i class="fas fa-ad text-yellow-500 text-4xl mb-3"></i>
                <h3 class="font-bold text-lg">‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶° ‡¶è‡¶°</h3>
                <p class="text-gray-600">‡¶è‡¶á ‡¶è‡¶°‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡ßá ‡¶™‡¶æ‡¶¨‡ßá‡¶® <span class="font-bold text-green-600">‡ß©‡ß¶.‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ</span></p>
            </div>
            
            <!-- ‡¶è‡¶° ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶è‡¶∞‡¶ø‡ßü‡¶æ -->
            <div class="bg-gray-100 rounded-lg p-4 text-center mb-4">
                <div id="adContent">
                    <h4 class="font-bold text-lg mb-2">üé¨ ‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶° ‡¶è‡¶°</h4>
                    <p class="text-gray-600 mb-3">‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</p>
                    
                    <div class="bg-white p-4 rounded-lg border border-gray-300">
                        <i class="fas fa-video text-blue-500 text-3xl mb-2"></i>
                        <p class="text-sm text-gray-500 mb-3">‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                        
                        <!-- Monetag Ad Container -->
                        <div id="monetag-ad-container"></div>
                        
                        <p class="text-xs text-gray-400 mt-2" id="adStatus">‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                    </div>
                </div>
            </div>
            
            <!-- ‡¶¶‡ßÅ‡¶á‡¶ü‡¶ø ‡¶¨‡¶æ‡¶ü‡¶® -->
            <div class="grid grid-cols-2 gap-3 mb-3">
                <button onclick="loadMonetagAd()" id="loadAdBtn" class="bg-blue-500 text-white py-3 rounded-lg font-bold">
                    <i class="fas fa-download mr-2"></i>
                    ‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
                
                <button onclick="showMonetagAd()" id="watchAdBtn" class="bg-gray-400 text-white py-3 rounded-lg font-bold" disabled>
                    <i class="fas fa-play mr-2"></i>
                    ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                </button>
            </div>
            
            <div class="text-center">
                <p class="text-gray-500 text-sm" id="rewardStatus">‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá "‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®" ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ "‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®"</p>
            </div>
        </div>

        <!-- ‡¶§‡¶•‡ßç‡¶Ø -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4">
            <div class="flex items-start">
                <i class="fas fa-info-circle text-yellow-500 mt-1 mr-2"></i>
                <div>
                    <h4 class="font-semibold text-yellow-700">‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶§‡¶•‡ßç‡¶Ø</h4>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá "‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®" ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá "‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®" ‡¶¨‡¶æ‡¶ü‡¶® ‡¶è‡¶ï‡ßç‡¶ü‡¶ø‡¶≠ ‡¶π‡¶¨‡ßá</p>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶™‡¶∞ ‡ß©‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ö‡¶ü‡ßã ‡¶Ø‡ßã‡¶ó ‡¶π‡¶¨‡ßá</p>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡ßü ‡ßß‡ß¶‡¶ü‡¶ø ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®</p>
                </div>
            </div>
        </div>

        <!-- ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶¨‡¶æ‡¶ü‡¶® -->
        <a href="tasks.html" class="w-full bg-gray-500 text-white py-3 rounded-xl font-bold text-center block mt-4">
            <i class="fas fa-arrow-left mr-2"></i>
            ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶™‡ßá‡¶ú‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®
        </a>
    </div>

    <!-- Monetag Ad Script -->
    <script>
        // Monetag configuration
        let monetagLoaded = false;
        let adReady = false;

        function loadMonetagScript() {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = 'https://sdk.monetag.com/?id=10166009';
                script.onload = () => {
                    monetagLoaded = true;
                    resolve();
                };
                script.onerror = () => {
                    reject(new Error('Monetag script failed to load'));
                };
                document.head.appendChild(script);
            });
        }

        // Load Monetag when page loads
        window.addEventListener('DOMContentLoaded', function() {
            loadMonetagScript().then(() => {
                console.log('Monetag script loaded successfully');
            }).catch(error => {
                console.error('Monetag script loading failed:', error);
                document.getElementById('adStatus').textContent = '‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ - ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®';
                document.getElementById('adStatus').className = 'text-xs text-red-600';
            });
        });
    </script>

    <script src="app.js"></script>
    <script>
        let adsWatched = 0;
        const maxAdsPerHour = 10;
        let isAdLoading = false;

        function initWatchAdsPage() {
            const user = getUserData();
            if (user) {
                adsWatched = user.today_ads || 0;
                updateCounter();
            }
        }

        function updateCounter() {
            document.getElementById('adsCounter').textContent = `${adsWatched}/${maxAdsPerHour}`;
            const progress = (adsWatched / maxAdsPerHour) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            if (adsWatched >= maxAdsPerHour) {
                document.getElementById('loadAdBtn').disabled = true;
                document.getElementById('watchAdBtn').disabled = true;
                document.getElementById('loadAdBtn').classList.add('bg-gray-400', 'cursor-not-allowed');
                document.getElementById('loadAdBtn').innerHTML = '<i class="fas fa-clock mr-2"></i>‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑';
            }
        }

        function loadMonetagAd() {
            if (adsWatched >= maxAdsPerHour) {
                alert('‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶è‡¶° ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑! ‡ßß ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡¶∞ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
                return;
            }

            if (!monetagLoaded) {
                alert('‡¶è‡¶° ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶è‡¶ñ‡¶®‡¶ì ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡¶®‡¶ø! ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ï‡ßç‡¶∑‡¶£ ‡¶™‡¶∞ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
                return;
            }

            isAdLoading = true;
            document.getElementById('loadAdBtn').disabled = true;
            document.getElementById('loadAdBtn').innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
            document.getElementById('adStatus').textContent = '‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
            document.getElementById('adStatus').className = 'text-xs text-yellow-600';

            // Wait for Monetag to be ready
            const checkAdReady = setInterval(() => {
                if (typeof show_10166009 !== 'undefined') {
                    clearInterval(checkAdReady);
                    adReady = true;
                    
                    document.getElementById('loadAdBtn').innerHTML = '<i class="fas fa-check mr-2"></i>‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®';
                    document.getElementById('loadAdBtn').classList.remove('bg-blue-500');
                    document.getElementById('loadAdBtn').classList.add('bg-green-500');
                    
                    document.getElementById('watchAdBtn').disabled = false;
                    document.getElementById('watchAdBtn').classList.remove('bg-gray-400');
                    document.getElementById('watchAdBtn').classList.add('bg-green-500');
                    
                    document.getElementById('adStatus').textContent = '‡¶è‡¶° ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§ - "‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®" ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®';
                    document.getElementById('adStatus').className = 'text-xs text-green-600';
                    document.getElementById('rewardStatus').textContent = '‡¶è‡¶ñ‡¶® "‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®" ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®';
                    
                    isAdLoading = false;
                }
            }, 500);

            // Timeout after 10 seconds
            setTimeout(() => {
                clearInterval(checkAdReady);
                if (!adReady) {
                    document.getElementById('loadAdBtn').disabled = false;
                    document.getElementById('loadAdBtn').innerHTML = '<i class="fas fa-download mr-2"></i>‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®';
                    document.getElementById('loadAdBtn').classList.remove('bg-green-500');
                    document.getElementById('loadAdBtn').classList.add('bg-blue-500');
                    document.getElementById('adStatus').textContent = '‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ - ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®';
                    document.getElementById('adStatus').className = 'text-xs text-red-600';
                    isAdLoading = false;
                }
            }, 10000);
        }

        function showMonetagAd() {
            if (!adReady) {
                alert('‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá "‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®" ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®!');
                return;
            }

            if (adsWatched >= maxAdsPerHour) {
                alert('‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶è‡¶° ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑!');
                return;
            }

            console.log('Showing Monetag ad...');

            // Show Monetag rewarded interstitial ad
            show_10166009().then(() => {
                console.log('Ad watched successfully - giving reward');
                // User watched the ad - give reward
                rewardUserForWatchingAd();
                
            }).catch((error) => {
                console.error('Ad failed to show:', error);
                alert('‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
                
                // Reset buttons
                resetAdButtons();
            });
        }

        function rewardUserForWatchingAd() {
            // Add reward
            adsWatched++;
            
            // Update user data
            const user = getUserData();
            const newBalance = user.balance + 30;
            const newTotalIncome = user.total_income + 30;
            const newTotalAds = user.total_ads + 1;
            
            updateUserData({ 
                today_ads: adsWatched,
                balance: newBalance,
                total_income: newTotalIncome,
                total_ads: newTotalAds
            });

            // Update UI
            updateCounter();
            
            document.getElementById('adStatus').textContent = '‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ‡ß©‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá';
            document.getElementById('adStatus').className = 'text-xs text-green-600';
            document.getElementById('rewardStatus').textContent = '‡ß©‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!';
            document.getElementById('rewardStatus').className = 'text-sm text-green-600 font-semibold';

            // Show success message
            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.showPopup({
                    title: '‡¶∏‡¶´‡¶≤!',
                    message: '‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ‡ß©‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§',
                    buttons: [{ type: 'close' }]
                });
            } else {
                alert('‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ‡ß©‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§');
            }
            
            // Reset for next ad
            setTimeout(() => {
                resetAdButtons();
            }, 3000);
        }

        function resetAdButtons() {
            if (adsWatched < maxAdsPerHour) {
                adReady = false;
                
                document.getElementById('loadAdBtn').disabled = false;
                document.getElementById('loadAdBtn').innerHTML = '<i class="fas fa-download mr-2"></i>‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®';
                document.getElementById('loadAdBtn').classList.remove('bg-green-500');
                document.getElementById('loadAdBtn').classList.add('bg-blue-500');
                
                document.getElementById('watchAdBtn').disabled = true;
                document.getElementById('watchAdBtn').classList.remove('bg-green-500');
                document.getElementById('watchAdBtn').classList.add('bg-gray-400');
                
                document.getElementById('adStatus').textContent = '‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
                document.getElementById('adStatus').className = 'text-xs text-gray-600';
                document.getElementById('rewardStatus').textContent = '‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá "‡¶è‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®" ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®';
                document.getElementById('rewardStatus').className = 'text-gray-500 text-sm';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            initWatchAdsPage();
        });
    </script>
</body>
</html>