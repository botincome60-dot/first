<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∏‡¶π‡¶ú ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ - ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        body {
            padding-bottom: 20px;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .task-completed {
            background: #f0f9ff !important;
            border-color: #bae6fd !important;
        }
        .current-task {
            border: 2px solid #3B82F6;
            background: #EFF6FF;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-gray-600">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
        </div>
    </div>

    <div class="container mx-auto px-4 py-4 fade-in">
        <!-- ‡¶π‡ßá‡¶°‡¶æ‡¶∞ -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-4 text-white mb-4">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="font-bold text-lg">‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü</h2>
                    <p class="text-white/80 text-sm">‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                </div>
                <i class="fas fa-globe text-2xl"></i>
            </div>
        </div>

        <!-- ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶®‡¶ø‡ßü‡¶Æ ‡¶¨‡¶æ‡¶ü‡¶® -->
        <div class="bg-white rounded-xl p-4 shadow-sm mb-4">
            <h3 class="font-bold text-lg mb-3">‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶®‡¶ø‡ßü‡¶Æ</h3>
            <button onclick="watchTutorial()" class="w-full bg-purple-500 text-white py-3 rounded-lg font-bold hover:bg-purple-600 transition-colors">
                <i class="fas fa-video mr-2"></i>
                ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶®‡¶ø‡ßü‡¶Æ‡ßá‡¶∞ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
            </button>
        </div>

        <!-- ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï -->
        <div class="bg-white rounded-xl p-4 shadow-sm mb-4" id="currentTaskSection">
            <h3 class="font-bold text-lg mb-3">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</h3>
            
            <div class="bg-blue-50 border-2 border-blue-300 rounded-lg p-4 mb-4 current-task" id="currentTaskCard">
                <div class="text-center">
                    <div class="flex justify-center mb-2">
                        <span class="bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-bold">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®</span>
                    </div>
                    <i class="fas fa-globe-americas text-blue-500 text-3xl mb-2"></i>
                    <h4 class="font-bold text-lg" id="currentTaskName">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</h4>
                    <p class="text-gray-600 mb-3" id="currentTaskDesc">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                    
                    <!-- ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® -->
                    <button onclick="visitCurrentWebsite()" id="visitBtn" class="w-full bg-green-500 text-white py-3 rounded-lg font-bold mb-3 hover:bg-green-600 transition-colors">
                        <i class="fas fa-external-link-alt mr-2"></i>
                        ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                    </button>
                    
                    <p class="text-blue-600 text-sm">
                        ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá ‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶®‡ßã‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                    </p>
                </div>
            </div>

            <!-- ‡¶ï‡ßã‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® -->
            <div class="mt-4">
                <h4 class="font-semibold mb-2">‡¶ï‡ßã‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®</h4>
                <div class="mb-3">
                    <input type="text" id="codeInput" placeholder="‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" 
                        class="w-full border border-gray-300 rounded-lg p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition-colors">
                </div>
                
                <button onclick="verifyCurrentCode()" id="verifyBtn" class="w-full bg-blue-500 text-white py-3 rounded-lg font-bold hover:bg-blue-600 transition-colors">
                    ‡¶ï‡ßã‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
                
                <p class="text-gray-500 text-sm mt-2 text-center" id="statusMessage">
                    ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡ßã‡¶° ‡¶¶‡¶ø‡¶≤‡ßá ‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡¶æ‡¶¨‡ßá‡¶®
                </p>
            </div>
        </div>

        <!-- ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü‡ßá‡¶° ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶∏ -->
        <div class="bg-white rounded-xl p-4 shadow-sm mb-4" id="completedSection" style="display: none;">
            <h3 class="font-bold text-lg mb-3">‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶∏</h3>
            <div id="completedTasksList" class="space-y-3">
                <!-- ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü‡ßá‡¶° ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá -->
            </div>
        </div>

        <!-- ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® (‡¶°‡¶ø‡¶¨‡¶æ‡¶ó ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø) -->
        <div class="bg-red-50 border border-red-200 rounded-xl p-4 mb-4">
            <h4 class="font-semibold text-red-700 mb-2">‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø</h4>
            <button onclick="resetAllProgress()" class="w-full bg-red-500 text-white py-2 rounded-lg font-semibold hover:bg-red-600 transition-colors">
                <i class="fas fa-redo mr-2"></i>
                ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            </button>
            <p class="text-red-600 text-xs mt-2 text-center">‡¶è‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø, ‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡¶∂‡¶®‡ßá remove ‡¶ï‡¶∞‡¶¨‡ßá‡¶®</p>
        </div>

        <!-- ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4">
            <div class="flex items-start">
                <i class="fas fa-info-circle text-yellow-500 mt-1 mr-2"></i>
                <div>
                    <h4 class="font-semibold text-yellow-700">‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶§‡¶•‡ßç‡¶Ø</h4>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶è‡¶ï‡¶ü‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶è‡¶ï‡¶ü‡¶æ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶π‡¶≤‡ßá ‡¶™‡¶∞‡ßá‡¶∞ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Ü‡¶∏‡¶¨‡ßá</p>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶ø‡¶§ ‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶®‡ßã‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    <p class="text-yellow-600 text-sm">‚Ä¢ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡ßã‡¶°‡ßá ‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</p>
                </div>
            </div>
        </div>

        <!-- ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶¨‡¶æ‡¶ü‡¶® -->
        <a href="tasks.html" class="w-full bg-gray-500 text-white py-3 rounded-xl font-bold text-center block mt-4 hover:bg-gray-600 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i>
            ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶™‡ßá‡¶ú‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®
        </a>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="app.js"></script>

    <script>
        // ‡¶∏‡¶ï‡¶≤ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü - ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá REAL ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶¶‡¶ø‡¶¨‡ßá‡¶®
        const ALL_WEBSITES = [
            {
                id: 1,
                name: "‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü #1",
                code: "WEB001", // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶ï‡ßã‡¶°
                link: "https://www.khanacademy.org/", // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï
                description: "‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®"
            }
            // {
            //     id: 2, 
            //     name: "‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü #2",
            //     code: "WEB002", // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶ï‡ßã‡¶°
            //     link: "https://example2.com", // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï
            //     description: "‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®"
            // },
            // {
            //     id: 3,
            //     name: "‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü #3", 
            //     code: "WEB003", // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶ï‡ßã‡¶°
            //     link: "https://example3.com", // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï
            //     description: "‡¶§‡ßÉ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®"
            // }
            // ‡¶®‡¶§‡ßÅ‡¶® ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶á array ‡¶§‡ßá ‡¶®‡¶§‡ßÅ‡¶® object ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶¨‡ßá‡¶®
        ];

        let currentWebsite = null;
        let completedWebsites = [];

        function initWebsiteVisitPage() {
            console.log("üîÑ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...");
            loadUserProgress();
            updateUI();
            hideLoading();
        }

        function loadUserProgress() {
            const user = getUserData();
            if (!user) {
                console.log("‚ùå ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á");
                return;
            }

            console.log("üë§ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞:", user.id);
            
            const userProgress = JSON.parse(localStorage.getItem('websiteProgress') || '{}');
            completedWebsites = userProgress[user.id] || [];
            
            console.log("‚úÖ ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü‡ßá‡¶° ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü:", completedWebsites);

            // ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶á‡¶®‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü‡ßá‡¶°)
            currentWebsite = ALL_WEBSITES.find(website => !completedWebsites.includes(website.id));
            
            console.log("üéØ ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü:", currentWebsite);
        }

        function updateUI() {
            const currentTaskSection = document.getElementById('currentTaskSection');
            const completedSection = document.getElementById('completedSection');

            if (currentWebsite) {
                // ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®
                document.getElementById('currentTaskName').textContent = currentWebsite.name;
                document.getElementById('currentTaskDesc').textContent = currentWebsite.description;
                
                // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶®
                document.getElementById('visitBtn').disabled = false;
                document.getElementById('visitBtn').classList.remove('bg-gray-400', 'cursor-not-allowed');
                document.getElementById('visitBtn').classList.add('bg-green-500', 'hover:bg-green-600');
                document.getElementById('visitBtn').innerHTML = '<i class="fas fa-external-link-alt mr-2"></i>‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®';
                
                document.getElementById('verifyBtn').disabled = false;
                document.getElementById('verifyBtn').classList.remove('bg-gray-400', 'cursor-not-allowed');
                document.getElementById('verifyBtn').classList.add('bg-blue-500', 'hover:bg-blue-600');
                document.getElementById('verifyBtn').innerHTML = '‡¶ï‡ßã‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®';
                
                document.getElementById('codeInput').disabled = false;
                document.getElementById('codeInput').placeholder = '‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®';
                document.getElementById('codeInput').value = '';
                
                currentTaskSection.style.display = 'block';
                document.getElementById('statusMessage').textContent = '‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡ßã‡¶° ‡¶¶‡¶ø‡¶≤‡ßá ‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡¶æ‡¶¨‡ßá‡¶®';
                document.getElementById('statusMessage').className = 'text-gray-500 text-sm mt-2 text-center';
                
                console.log("‚úÖ ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá:", currentWebsite.name);
            } else {
                // ‡¶∏‡¶¨ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü
                currentTaskSection.style.display = 'block';
                document.getElementById('currentTaskName').textContent = '‡¶∏‡¶¨ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!';
                document.getElementById('currentTaskDesc').textContent = '‡¶Ü‡¶™‡¶®‡¶ø ‡¶∏‡¶¨ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®';
                
                // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶®
                document.getElementById('visitBtn').disabled = true;
                document.getElementById('visitBtn').classList.remove('bg-green-500', 'hover:bg-green-600');
                document.getElementById('visitBtn').classList.add('bg-gray-400', 'cursor-not-allowed');
                document.getElementById('visitBtn').innerHTML = '<i class="fas fa-check mr-2"></i>‡¶∏‡¶¨ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®';
                
                document.getElementById('verifyBtn').disabled = true;
                document.getElementById('verifyBtn').classList.remove('bg-blue-500', 'hover:bg-blue-600');
                document.getElementById('verifyBtn').classList.add('bg-gray-400', 'cursor-not-allowed');
                document.getElementById('verifyBtn').innerHTML = '‡¶∏‡¶¨ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®';
                
                document.getElementById('codeInput').disabled = true;
                document.getElementById('codeInput').placeholder = '‡¶∏‡¶¨ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®';
                
                document.getElementById('statusMessage').textContent = '‡¶Ü‡¶™‡¶®‡¶ø ‡¶∏‡¶¨ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®!';
                document.getElementById('statusMessage').className = 'text-green-600 text-sm mt-2 text-center font-semibold';
                
                console.log("‚úÖ ‡¶∏‡¶¨ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®");
            }

            // ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü‡ßá‡¶° ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®
            if (completedWebsites.length > 0) {
                completedSection.style.display = 'block';
                renderCompletedTasks();
            } else {
                completedSection.style.display = 'none';
            }
        }

        function renderCompletedTasks() {
            const completedList = document.getElementById('completedTasksList');
            completedList.innerHTML = '';

            completedWebsites.forEach(websiteId => {
                const website = ALL_WEBSITES.find(w => w.id === websiteId);
                if (website) {
                    const taskCard = document.createElement('div');
                    taskCard.className = 'border border-gray-200 rounded-lg p-3 task-completed';
                    
                    taskCard.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div>
                                <h4 class="font-semibold">${website.name}</h4>
                                <p class="text-gray-600 text-sm">${website.description}</p>
                            </div>
                            <div class="text-right">
                                <span class="bg-green-500 text-white px-2 py-1 rounded text-xs">‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®</span>
                                <p class="text-green-600 text-sm font-semibold mt-1">‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ</p>
                            </div>
                        </div>
                    `;
                    
                    completedList.appendChild(taskCard);
                }
            });
        }

        function visitCurrentWebsite() {
            if (!currentWebsite) {
                showNotification('‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶®‡ßá‡¶á!', 'error');
                return;
            }

            showNotification(
                `üåê ${currentWebsite.name} ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®\n\n‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá ‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶®‡ßã‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶™‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßá ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`,
                "info"
            );

            // ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶ì‡¶™‡ßá‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® - ‡¶è‡¶ñ‡¶® ‡¶Ü‡¶∏‡¶≤ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá
            setTimeout(() => {
                window.open(currentWebsite.link, '_blank');
            }, 2000);
        }

        async function verifyCurrentCode() {
            if (!currentWebsite) {
                showNotification('‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶®‡ßá‡¶á!', 'error');
                return;
            }

            const inputCode = document.getElementById('codeInput').value.trim();
            
            if (!inputCode) {
                showNotification('‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!', 'error');
                return;
            }

            if (inputCode !== currentWebsite.code) {
                showNotification('‡¶≠‡ßÅ‡¶≤ ‡¶ï‡ßã‡¶°! ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡ßã‡¶°‡¶ü‡¶ø ‡¶¶‡¶ø‡¶®‡•§', 'error');
                return;
            }

            // ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡ßã‡¶° - ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶¶‡¶ø‡¶®
            try {
                const user = getUserData();
                if (user) {
                    await updateUserData({ 
                        balance: user.balance + 50,
                        total_income: user.total_income + 50
                    });
                    
                    // ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ú ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü‡ßá‡¶°
                    const userProgress = JSON.parse(localStorage.getItem('websiteProgress') || '{}');
                    if (!userProgress[user.id]) {
                        userProgress[user.id] = [];
                    }
                    
                    // ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶®‡ßá‡¶á
                    if (!userProgress[user.id].includes(currentWebsite.id)) {
                        userProgress[user.id].push(currentWebsite.id);
                        localStorage.setItem('websiteProgress', JSON.stringify(userProgress));
                    }
                    
                    showNotification(`üéâ ‡¶∏‡¶´‡¶≤! ${currentWebsite.name} ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü! ‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá!`, 'success');
                    
                    // UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                    document.getElementById('codeInput').value = '';
                    loadUserProgress();
                    updateUI();
                    
                }
            } catch (error) {
                console.error('Error rewarding website task:', error);
                showNotification('‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶è‡¶∞‡¶∞! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
            }
        }

        // ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡¶ø‡¶Ç ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
        function resetAllProgress() {
            const user = getUserData();
            if (!user) return;

            const userProgress = JSON.parse(localStorage.getItem('websiteProgress') || '{}');
            userProgress[user.id] = [];
            localStorage.setItem('websiteProgress', JSON.stringify(userProgress));
            
            showNotification('‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!', 'success');
            
            // UI ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®
            loadUserProgress();
            updateUI();
        }

        function watchTutorial() {
            const videoLink = "https://youtu.be/XLXw5o1uU3E?si=HmuoguPxrQY4PmkH";
            window.open(videoLink, '_blank');
            showNotification("‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶®‡¶ø‡ßü‡¶Æ ‡¶∂‡¶ø‡¶ñ‡ßÅ‡¶®!", "info");
        }

        function showNotification(message, type = 'info') {
            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.showPopup({
                    title: type === 'success' ? '‡¶∏‡¶´‡¶≤!' : '‡¶Æ‡ßá‡¶∏‡ßá‡¶ú',
                    message: message,
                    buttons: [{ type: 'close' }]
                });
            } else {
                alert(message);
            }
        }

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initWebsiteVisitPage, 1000);
        });
    </script>
</body>
</html>